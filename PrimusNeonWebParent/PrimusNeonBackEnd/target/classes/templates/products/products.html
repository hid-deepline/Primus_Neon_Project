<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head
	th:replace="~{fragments :: page_head('Produits - Administration de Primus Neon', 'none')}"></head>
<body>
	<div class="container-fluid">
		<div th:replace="~{navigation :: menu}"></div>
		<div>
			<h2>Gestion des produits</h2>

			<a th:href="@{/products/new}"
				class="fas fa-folder-plus fa-2x icon-dark mr-2"></a> <a
				th:href="@{/products/export/csv}"
				class="fas fa-file-csv fa-2x icon-dark mr-2"></a>
		</div>

		<div th:replace="~{fragments :: search_form_and_message}"></div>

		<div class="full-details">
			<table
				class="table table-bordered table-striped table-hover table-responsive-xl">
				<thead class="table-dark">
					<tr>
						<th class="hideable-column" 
							th:replace="~{fragments :: column_link('/products', 'id', 'ID', 'none')}"></th>
						<th>Image Principale</th>
						<th
							th:replace="~{fragments :: column_link('/products', 'name', 'Nom produit', 'none')}"></th>
						<th 
							th:replace="~{fragments :: column_link('/products', 'brand', 'Marque', 'none')}">Marque</th>
						<th 
							th:replace="~{fragments :: column_link('/products', 'category', 'Catégorie', 'none')}"></th>
						<th 
							th:replace="~{fragments :: column_link('/products', 'enabled', 'Activé', 'none')}">Activé</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="product : ${listProducts}">
						<td class="hideable-column">[[${product.id}]]</td>
						<td><img th:src="@{${product.mainImagePath}}"
							alt="Image principale" class="img-fluid" style="width: 120px" />
						</td>
						<td><a class="link-detail"
							th:href="@{'/products/detail/' + ${product.id}}"
							title="Description du produit">[[${product.name}]]</a>

						</td>
						<td>[[${product.brand.name}]]</td>
						<td>[[${product.category.name}]]</td>
						<td>
							<div
								th:replace="~{fragments :: status(${product.enabled}, 'ce produit', '/products/' + ${product.id})}"></div>
						</td>
						<td><a class="fas fa-file-alt fa-2x icon-green link-detail"
							th:href="@{'/products/detail/' + ${product.id}}"
							title="Description du produit"></a> &nbsp;
							<div
								th:replace="~{fragments :: edit('ce produit', '/products/edit/' + ${product.id})}"></div>
							&nbsp;
							<div
								th:replace="~{fragments :: delete('ce produit', ${product.id}, '/products/delete/' + ${product.id}, true)}"></div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="less-details">
			<div th:each="product: ${listProducts}" class="row m-1">
				<div class="col-6">Image</div>
				<div class="col-6">
					<div>[[${product.name}]]</div>
					<div class="mt-2">
						<div
							th:replace="~{fragments :: edit('ce produit', '/products/edit/' + ${product.id})}"></div>
						&nbsp;
						<div
							th:replace="~{fragments :: delete('ce produit', ${product.id}, '/products/delete/' + ${product.id}, true)}"></div>
					</div>
				</div>
				<div>&nbsp;</div>
			</div>
		</div>



		<div th:replace="~{modal_fragments :: confirm_modal}"></div>
		
		<div class="modal fade" id="detailModal">
			<div class="modal-dialog modal-xl">
				<div class="modal-content">
					
					</div>

			</div>
		</div>

		<div th:replace="~{fragments :: pagination('Produits')}"></div>

		<div th:replace="~{fragments :: footer}"></div>
	</div>

	<script th:src="@{/js/common_list.js}"></script>
	<script type="text/javascript">
		moduleURL = "[[@{/products}]]";

		$(document).ready(function() {
			$(".link-delete").on("click", function(e) {
				e.preventDefault();
				showDeleteConfirmModal($(this), 'produit');
			});

			$(".link-detail").on("click", function(e) {
				e.preventDefault();
				linkDetailURL = $(this).attr("href");
				$("#detailModal").modal("show").find(".modal-content").load(linkDetailURL);
			});
		});
		function clearFilter() {
			window.location = "[[@{/products}]]";

		};
	</script>
</body>
</html>